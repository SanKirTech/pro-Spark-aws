{"kpiindex":"k1a","kpitable":"retail_kpi.t_sku_revenue_w_dly","kpidiscription":"Rank the SKUs based on the revenue - Worldwide", "kpiquery":"select stockcode, sum(quantity * unitprice) as revenue, rank() over (order by sum(quantity * unitprice) desc ) as rank from %s group by stockcode"}
{"kpiindex":"k1b","kpitable":"retail_kpi.t_sku_revenue_c_dly","kpidiscription":"Rank the SKUs based on the revenue - Countrywide","kpiquery": "select stockcode, country, sum(quantity * unitprice) as revenue, rank() over ( order by sum(quantity * unitprice) desc ) as rank from %s group by stockcode, country"}
{"kpiindex":"k2", "kpitable":"retail_kpi.t_revenue_country_dly","kpidiscription":"Rank the Countries based on the revenue (highest to lowest)","kpiquery": "select country, sum(quantity * unitprice) as revenue,rank() over (order by sum(quantity * unitprice) desc) as rank from %s group by country"}
{"kpiindex":"k3", "kpitable":"retail_kpi.t_revenue_qtr_dly","kpidiscription":"Revenue per SKU - Quarterwise","kpiquery": "select stockcode, year(invoicedate) as year1, quarter(invoicedate) qtr, sum(quantity * unitprice) as revenue from %s group by stockcode, year(invoicedate), quarter(invoicedate) order by stockcode,year(invoicedate), quarter(invoicedate)"}
{"kpiindex":"k4", "kpitable":"retail_kpi.t_revenue_country_qtr_dly","kpidiscription":"Revenue per country - Quarterwise","kpiquery": "select country, year(invoicedate) as year1, quarter(invoicedate) as qtr, sum(quantity * unitprice) as revenue from %s group by country, year(invoicedate), quarter(invoicedate) order by revenue desc"}
{"kpiindex":"k5", "kpitable":"retail_kpi.t_customer_rank_dly","kpidiscription":"Rank the Customers based on the business value","kpiquery": "select customerid, sum(quantity * unitprice) as revenue, rank() over (order by sum(quantity * unitprice) desc) as rank from %s group by customerid"}
{"kpiindex":"k6","kpitable":"retail_kpi.t_sku_dow_dly","kpidiscription":"Highest selling SKUs on a daily basis (M,T,W,Th,F,S,Su) per country","kpiquery":"select distinct stockcode,  sum(round(quantity * unitprice)) over w as revenue,dayofweek(InvoiceDate) as Day_Of_Week, country from %s window w as (partition by stockcode, country order by dayofweek(InvoiceDate),country) order by revenue desc, Day_Of_Week,country" }
{"kpiindex":"k7","kpitable":"retail_kpi.t_sales_anomaly_dly","kpidiscription":"Identify Sales Anomalies in any month for a given SKU","kpiquery": "select stockcode, year(invoicedate) as year1, month(invoicedate)  as month1, sum(quantity * unitprice) as Revenue from %s group by stockcode, year(invoicedate), month(invoicedate) order by stockcode, year(invoicedate), month(invoicedate)"}